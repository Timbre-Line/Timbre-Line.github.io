<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>è¯¦ç»†æµ‹è¯•å¤±è´¥æ¨¡å‹</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .test-case { padding: 15px; margin: 10px 0; border-left: 5px solid #ccc; }
        .success { border-left-color: #28a745; background: #d4edda; }
        .error { border-left-color: #dc3545; background: #f8d7da; }
        .testing { border-left-color: #ffc107; background: #fff3cd; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow: auto; }
        button { padding: 10px 20px; margin: 5px; }
        .error-details { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>ğŸ” è¯¦ç»†æµ‹è¯•å¤±è´¥æ¨¡å‹</h1>
    <p>æµ‹è¯•æ—¶é—´: <span id="timestamp"></span></p>
    
    <div id="controls">
        <button onclick="testAllFailedModels()">æµ‹è¯•æ‰€æœ‰å¤±è´¥æ¨¡å‹</button>
        <button onclick="testSpecificModel('gpt-5')">æµ‹è¯• gpt-5</button>
        <button onclick="testSpecificModel('gpt-5-mini')">æµ‹è¯• gpt-5-mini</button>
        <button onclick="testSpecificModel('gpt-5-nano')">æµ‹è¯• gpt-5-nano</button>
        <button onclick="testSpecificModel('gpt-5.1-chat')">æµ‹è¯• gpt-5.1-chat</button>
        <button onclick="testSpecificModel('gpt-5.1-codex')">æµ‹è¯• gpt-5.1-codex</button>
        <button onclick="testSpecificModel('gpt-5.2-chat')">æµ‹è¯• gpt-5.2-chat</button>
        <button onclick="testSpecificModel('gpt-5.2-pro')">æµ‹è¯• gpt-5.2-pro</button>
    </div>
    
    <div id="results">
        <h3>æµ‹è¯•ç»“æœ:</h3>
        <div id="test-output"></div>
    </div>
    
    <script src="https://js.puter.com/v2/"></script>
    <script>
        document.getElementById('timestamp').textContent = new Date().toLocaleString();
        
        // å¤±è´¥æ¨¡å‹åˆ—è¡¨ï¼ˆæ ¹æ®æ‚¨çš„æµ‹è¯•ç»“æœï¼‰
        const failedModels = [
            "openrouter:openai/gpt-5",
            "openrouter:openai/gpt-5-mini",
            "openrouter:openai/gpt-5-nano",
            "openrouter:openai/gpt-5.1-chat",
            "openrouter:openai/gpt-5.1-codex",
            "openrouter:openai/gpt-5.2-chat",
            "openrouter:openai/gpt-5.2-pro"
        ];
        
        // æˆåŠŸæ¨¡å‹ï¼ˆå¯¹æ¯”ç”¨ï¼‰
        const successModels = [
            "openrouter:openai/gpt-5-chat",
            "openrouter:openai/gpt-5-pro",
            "openrouter:openai/gpt-5.1",
            "openrouter:openai/gpt-5.1-codex-max",
            "openrouter:openai/gpt-5.2"
        ];
        
        const outputDiv = document.getElementById('test-output');
        
        // åˆ›å»ºæµ‹è¯•æ¡ç›®
        function createTestEntry(modelName) {
            const div = document.createElement('div');
            div.className = 'test-case testing';
            div.id = `test-${modelName.replace(/[:\/.-]/g, '_')}`;
            div.innerHTML = `
                <strong>${modelName}</strong>
                <div class="status">æµ‹è¯•ä¸­...</div>
                <div class="details" style="margin-top: 10px;"></div>
                <div class="error-details" style="display: none;"></div>
            `;
            return div;
        }
        
        // æ›´æ–°æµ‹è¯•ç»“æœ
        function updateTestResult(modelName, success, data, duration = null) {
            const testId = `test-${modelName.replace(/[:\/.-]/g, '_')}`;
            const div = document.getElementById(testId);
            if (!div) return;
            
            const statusDiv = div.querySelector('.status');
            const detailsDiv = div.querySelector('.details');
            const errorDiv = div.querySelector('.error-details');
            
            if (success) {
                div.className = 'test-case success';
                statusDiv.innerHTML = `âœ… æˆåŠŸ (${duration}ms)`;
                
                // æ˜¾ç¤ºå“åº”
                let responseText = '';
                if (typeof data === 'string') {
                    responseText = data;
                } else if (data?.message?.content) {
                    responseText = data.message.content;
                } else if (data?.content) {
                    responseText = data.content;
                }
                
                detailsDiv.innerHTML = `<p><strong>å“åº”:</strong> ${responseText || 'ç©ºå“åº”'}</p>`;
                
                // è°ƒè¯•ä¿¡æ¯
                console.log(`${modelName} æˆåŠŸ:`, data);
                
            } else {
                div.className = 'test-case error';
                statusDiv.innerHTML = 'âŒ å¤±è´¥';
                
                // æ˜¾ç¤ºè¯¦ç»†é”™è¯¯
                let errorObj = data;
                if (data?.error) {
                    errorObj = data.error;
                }
                
                detailsDiv.innerHTML = `<p><strong>é”™è¯¯ç±»å‹:</strong> ${errorObj?.code || 'æœªçŸ¥'}</p>`;
                errorDiv.innerHTML = `
                    <p><strong>å®Œæ•´é”™è¯¯ä¿¡æ¯:</strong></p>
                    <pre>${JSON.stringify(errorObj, null, 2)}</pre>
                `;
                errorDiv.style.display = 'block';
                
                // åˆ†æé”™è¯¯åŸå› 
                analyzeError(modelName, errorObj, detailsDiv);
                
                // è°ƒè¯•ä¿¡æ¯
                console.error(`${modelName} å¤±è´¥:`, errorObj);
            }
        }
        
        // åˆ†æé”™è¯¯åŸå› 
        function analyzeError(modelName, errorObj, detailsDiv) {
            const errorMsg = errorObj?.message || '';
            let analysis = '';
            
            if (errorMsg.includes('does not exist') || errorMsg.includes('not found')) {
                analysis = 'â“ æ¨¡å‹å¯èƒ½ä¸å­˜åœ¨æˆ–å·²ä¸‹çº¿';
            } else if (errorMsg.includes('rate limit') || errorMsg.includes('limit')) {
                analysis = 'â±ï¸ é€Ÿç‡é™åˆ¶æˆ–é…é¢ä¸è¶³';
            } else if (errorMsg.includes('access') || errorMsg.includes('permission')) {
                analysis = 'ğŸ” éœ€è¦ç‰¹æ®Šæƒé™æˆ–APIå¯†é’¥';
            } else if (errorMsg.includes('endpoint') || errorMsg.includes('end point')) {
                analysis = 'ğŸ”§ éœ€è¦ä¸åŒçš„APIç«¯ç‚¹';
            } else if (errorMsg.includes('parameters') || errorMsg.includes('invalid')) {
                analysis = 'âš™ï¸ å‚æ•°æ ¼å¼ä¸æ­£ç¡®';
            } else if (errorMsg.includes('fallback model')) {
                analysis = 'ğŸ”„ æ— å¤‡ç”¨æ¨¡å‹å¯ç”¨';
            }
            
            if (analysis) {
                detailsDiv.innerHTML += `<p><strong>åˆ†æ:</strong> ${analysis}</p>`;
            }
            
            // ç‰¹æ®Šæ¨¡å‹åˆ†æ
            if (modelName.includes('gpt-5.1-codex') && modelName.includes('max')) {
                detailsDiv.innerHTML += `<p><strong>æ³¨æ„:</strong> gpt-5.1-codex-max æˆåŠŸï¼Œä½† gpt-5.1-codex å¤±è´¥ï¼Œå¯èƒ½æ˜¯ä¸é—®çš„ç‰ˆæœ¬æˆ–æƒé™</p>`;
            }
            
            if (modelName.includes('gpt-5') && !modelName.includes('chat') && !modelName.includes('pro')) {
                detailsDiv.innerHTML += `<p><strong>æ¨¡å¼å·®å¼‚:</strong> gpt-5-chat æˆåŠŸä½† gpt-5 å¤±è´¥ï¼Œå¯èƒ½æ˜¯åŸºç¡€æ¨¡å‹å’ŒèŠå¤©æ¨¡å‹çš„åŒºåˆ«</p>`;
            }
        }
        
        // æµ‹è¯•å•ä¸ªæ¨¡å‹ï¼ˆå¸¦ä¸åŒå‚æ•°å°è¯•ï¼‰
        async function testModel(modelName) {
            const testDiv = createTestEntry(modelName);
            outputDiv.appendChild(testDiv);
            
            // å°è¯•ä¸åŒçš„å‚æ•°ç»„åˆ
            const testAttempts = [
                {
                    name: 'æ ‡å‡†å‚æ•°',
                    params: { model: modelName, max_tokens: 50, temperature: 0.3 }
                },
                {
                    name: 'çŸ­å“åº”',
                    params: { model: modelName, max_tokens: 10, temperature: 0 }
                },
                {
                    name: 'é•¿å“åº”',
                    params: { model: modelName, max_tokens: 100, temperature: 0.7 }
                },
                {
                    name: 'æç®€',
                    params: { model: modelName, max_tokens: 5, temperature: 0 }
                }
            ];
            
            for (const attempt of testAttempts) {
                try {
                    console.log(`å°è¯• ${modelName} å‚æ•°: ${attempt.name}`);
                    const startTime = Date.now();
                    const response = await puter.ai.chat("AIæ˜¯ä»€ä¹ˆï¼Ÿ", attempt.params);
                    const endTime = Date.now();
                    
                    updateTestResult(modelName, true, response, endTime - startTime);
                    return { success: true, attempt: attempt.name };
                    
                } catch (error) {
                    console.log(`${modelName} ${attempt.name} å¤±è´¥:`, error.message?.substring(0, 100));
                    
                    // å¦‚æœæ˜¯æœ€åä¸€ä¸ªå°è¯•ï¼Œæ˜¾ç¤ºé”™è¯¯
                    if (attempt === testAttempts[testAttempts.length - 1]) {
                        updateTestResult(modelName, false, error);
                        return { success: false, error: error };
                    }
                    
                    // ç­‰å¾…1ç§’å†è¯•
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
        }
        
        // æµ‹è¯•æ‰€æœ‰å¤±è´¥æ¨¡å‹
        async function testAllFailedModels() {
            outputDiv.innerHTML = '<h4>æµ‹è¯•å¤±è´¥æ¨¡å‹:</h4>';
            
            for (const model of failedModels) {
                await testModel(model);
                await new Promise(resolve => setTimeout(resolve, 2000)); // ç­‰å¾…2ç§’
            }
            
            // æ˜¾ç¤ºå¯¹æ¯”çš„æˆåŠŸæ¨¡å‹
            outputDiv.innerHTML += '<h4>å¯¹æ¯”æˆåŠŸæ¨¡å‹:</h4>';
            for (const model of successModels.slice(0, 3)) { // åªæµ‹è¯•å‰3ä¸ªæˆåŠŸæ¨¡å‹ä½œä¸ºå¯¹æ¯”
                await testModel(model);
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        }
        
        // æµ‹è¯•ç‰¹å®šæ¨¡å‹
        async function testSpecificModel(modelShortName) {
            const fullModelName = `openrouter:openai/${modelShortName}`;
            outputDiv.innerHTML = `<h4>è¯¦ç»†æµ‹è¯• ${fullModelName}:</h4>`;
            await testModel(fullModelName);
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•ä¸€ä¸ªå…³é”®æ¨¡å‹
        window.onload = async function() {
            // å…ˆæµ‹è¯• gpt-5 çœ‹çœ‹è¯¦ç»†é”™è¯¯
            setTimeout(() => {
                testSpecificModel('gpt-5');
            }, 1000);
        };
        
        // æ·»åŠ é¢å¤–çš„æµ‹è¯•åŠŸèƒ½ï¼šå°è¯•ä¸åŒçš„æŸ¥è¯¢
        async function testWithDifferentQueries(modelName) {
            const queries = [
                "Hello",
                "What is 2+2?",
                "Explain AI",
                "Write a haiku",
                "Translate 'hello' to Spanish"
            ];
            
            const results = [];
            for (const query of queries) {
                try {
                    const response = await puter.ai.chat(query, {
                        model: modelName,
                        max_tokens: 20
                    });
                    results.push({ query, success: true, response });
                } catch (error) {
                    results.push({ query, success: false, error });
                }
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            return results;
        }
        
        // æ·»åŠ è¿™ä¸ªå‡½æ•°åˆ°å…¨å±€ï¼Œæ–¹ä¾¿è°ƒè¯•
        window.detailedTest = testWithDifferentQueries;
    </script>
    
    <div style="margin-top: 30px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
        <h3>æµ‹è¯•è¯´æ˜</h3>
        <p><strong>ç›®æ ‡ï¼š</strong>æ‰¾å‡ºè¿™äº›æ¨¡å‹å¤±è´¥çš„å…·ä½“åŸå› </p>
        <p><strong>æµ‹è¯•æ–¹æ³•ï¼š</strong></p>
        <ul>
            <li>æ¯ä¸ªæ¨¡å‹å°è¯•4ç§ä¸åŒçš„å‚æ•°ç»„åˆ</li>
            <li>æ˜¾ç¤ºå®Œæ•´çš„é”™è¯¯ä¿¡æ¯</li>
            <li>åˆ†æå¯èƒ½çš„å¤±è´¥åŸå› </li>
            <li>ä¸æˆåŠŸæ¨¡å‹å¯¹æ¯”</li>
        </ul>
        
        <h4>å¯èƒ½çš„åŸå› ï¼š</h4>
        <ol>
            <li><strong>æ¨¡å‹ä¸å­˜åœ¨ï¼š</strong>æŸäº›æ¨¡å‹å¯èƒ½ä»æœªå‘å¸ƒæˆ–å·²ä¸‹çº¿</li>
            <li><strong>æƒé™é™åˆ¶ï¼š</strong>éœ€è¦ç‰¹æ®ŠAPIå¯†é’¥æˆ–ä»˜è´¹è®¡åˆ’</li>
            <li><strong>å‚æ•°é—®é¢˜ï¼š</strong>éœ€è¦ç‰¹å®šçš„å‚æ•°æ ¼å¼</li>
            <li><strong>ç‰ˆæœ¬å·®å¼‚ï¼š</strong>å¦‚ gpt-5 åŸºç¡€æ¨¡å‹ vs gpt-5-chat</li>
            <li><strong>åŒºåŸŸé™åˆ¶ï¼š</strong>æŸäº›æ¨¡å‹å¯èƒ½åœ°åŒºå—é™</li>
        </ol>
        
        <p><em>æç¤ºï¼šæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰æŸ¥çœ‹æ›´å¤šè°ƒè¯•ä¿¡æ¯</em></p>
    </div>
</body>
</html>
