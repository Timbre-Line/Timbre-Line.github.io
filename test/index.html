<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>详细错误调试</title>
</head>
<body>
    <h2>o1-mini 详细错误分析</h2>
    <div id="debug"></div>
    
    <script src="https://js.puter.com/v2/"></script>
    <script>
        const debug = document.getElementById('debug');
        
        async function testWithDetails() {
            debug.innerHTML = "<p>测试中...</p>";
            
            // 测试 o1-mini 并捕获完整错误
            try {
                const response = await puter.ai.chat("1+1=?", {
                    model: "o1-mini",
                    max_tokens: 10
                });
                debug.innerHTML = `<p style="color:green">✅ 成功: ${response}</p>`;
            } catch (error) {
                // 详细显示错误对象的所有属性
                debug.innerHTML = `
                    <h3 style="color:red">❌ o1-mini 错误详情：</h3>
                    <pre>${JSON.stringify(error, null, 2)}</pre>
                    <p><strong>错误类型：</strong> ${error?.constructor?.name || '未知'}</p>
                    <p><strong>错误消息：</strong> ${error?.message || '无消息'}</p>
                    <p><strong>错误状态：</strong> ${error?.status || '无状态'}</p>
                    <p><strong>错误代码：</strong> ${error?.code || '无代码'}</p>
                    <p><strong>堆栈：</strong><br>${error?.stack || '无堆栈'}</p>
                `;
                
                console.error("完整错误对象:", error);
                
                // 尝试其他可能的模型名称
                await testAlternatives();
            }
        }
        
        async function testAlternatives() {
            debug.innerHTML += "<h3>尝试替代方案：</h3>";
            
            const alternatives = [
                "o1-mini-2025",
                "openai/o1-mini", 
                "gpt-o1-mini",
                "o1-mini-latest",
                "o1-mini-preview"
            ];
            
            for (const alt of alternatives) {
                try {
                    const response = await puter.ai.chat("1+1=?", {
                        model: alt,
                        max_tokens: 5
                    });
                    debug.innerHTML += `<p style="color:green">✅ ${alt}: ${response}</p>`;
                    return; // 找到可用的就停止
                } catch (err) {
                    debug.innerHTML += `<p style="color:gray">❌ ${alt}: ${err.message || err}</p>`;
                }
                await new Promise(resolve => setTimeout(resolve, 500));
            }
        }
        
        // 同时测试 o1 和 o1-mini 对比
        async function compareO1andO1Mini() {
            debug.innerHTML += "<h3>对比测试：</h3>";
            
            // 测试 o1（已知能工作）
            try {
                const o1Response = await puter.ai.chat("1+1=?", {
                    model: "o1",
                    max_tokens: 5
                });
                debug.innerHTML += `<p>✅ o1: ${o1Response}</p>`;
            } catch (err) {
                debug.innerHTML += `<p>❌ o1: ${err.message}</p>`;
            }
            
            // 等待后测试 o1-mini
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            try {
                const o1MiniResponse = await puter.ai.chat("1+1=?", {
                    model: "o1-mini",
                    max_tokens: 5
                });
                debug.innerHTML += `<p>✅ o1-mini: ${o1MiniResponse}</p>`;
            } catch (err) {
                debug.innerHTML += `<p>❌ o1-mini: ${err.message || JSON.stringify(err)}</p>`;
            }
        }
        
        // 运行测试
        testWithDetails();
        setTimeout(compareO1andO1Mini, 2000);
    </script>
</body>
</html>
