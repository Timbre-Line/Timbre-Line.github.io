<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>OpenRouter GPT æ¨¡å‹å…¨é¢æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .model-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0; }
        .model-card { padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .testing { background: #fff3cd; border-color: #ffeaa7; }
        .controls { margin: 20px 0; }
        button { padding: 10px 20px; margin: 5px; }
        .filter { margin: 10px 0; }
        .filter select { padding: 5px; margin: 0 10px; }
        .progress { margin: 20px 0; }
        .progress-bar { height: 10px; background: #eee; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; background: #007bff; width: 0%; transition: width 0.5s; }
        h4 { margin: 15px 0 10px 0; color: #333; }
        .summary { background: #e7f3ff; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .model-name { font-weight: bold; font-size: 14px; word-break: break-word; }
        .model-status { font-size: 12px; margin: 5px 0; }
        .model-details { font-size: 11px; color: #666; }
    </style>
</head>
<body>
    <h1>ğŸ¤– OpenRouter GPT æ¨¡å‹å…¨é¢æµ‹è¯•</h1>
    <p>æµ‹è¯•æ—¶é—´: <span id="timestamp"></span></p>
    
    <div class="summary">
        <h3>æµ‹è¯•è¯´æ˜</h3>
        <p>æµ‹è¯•æ‰€æœ‰ OpenRouter ä¸Šçš„ GPT æ¨¡å‹ï¼ˆä¸åŒ…æ‹¬æœ‰é—®é¢˜çš„ o ç³»åˆ—ï¼‰</p>
        <p><strong>æ€»æ¨¡å‹æ•°: <span id="total-models">0</span></strong></p>
    </div>
    
    <div class="controls">
        <button onclick="startSequentialTest()">å¼€å§‹é¡ºåºæµ‹è¯•</button>
        <button onclick="stopTest()">åœæ­¢æµ‹è¯•</button>
        <button onclick="testSelectedModels()">æµ‹è¯•é€‰ä¸­æ¨¡å‹</button>
        <button onclick="clearResults()">æ¸…é™¤ç»“æœ</button>
    </div>
    
    <div class="filter">
        <label>è¿‡æ»¤æ¨¡å‹:</label>
        <select id="version-filter">
            <option value="all">å…¨éƒ¨ç‰ˆæœ¬</option>
            <option value="3.5">GPT-3.5 ç³»åˆ—</option>
            <option value="4">GPT-4 ç³»åˆ—</option>
            <option value="4o">GPT-4o ç³»åˆ—</option>
            <option value="5">GPT-5 ç³»åˆ—</option>
            <option value="5.1">GPT-5.1 ç³»åˆ—</option>
            <option value="5.2">GPT-5.2 ç³»åˆ—</option>
        </select>
        
        <select id="status-filter">
            <option value="all">å…¨éƒ¨çŠ¶æ€</option>
            <option value="success">ä»…æˆåŠŸ</option>
            <option value="error">ä»…å¤±è´¥</option>
            <option value="testing">ä»…æµ‹è¯•ä¸­</option>
        </select>
        
        <button onclick="applyFilters()">åº”ç”¨è¿‡æ»¤</button>
        <button onclick="resetFilters()">é‡ç½®è¿‡æ»¤</button>
    </div>
    
    <div class="progress">
        <div id="progress-text">å‡†å¤‡å¼€å§‹æµ‹è¯•...</div>
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
        </div>
    </div>
    
    <div id="results">
        <h3>æµ‹è¯•ç»“æœ:</h3>
        <div class="model-grid" id="model-grid"></div>
    </div>
    
    <div id="summary" class="summary" style="display: none;">
        <h3>ğŸ“Š æµ‹è¯•æ€»ç»“</h3>
        <div id="summary-content"></div>
    </div>
    
    <script src="https://js.puter.com/v2/"></script>
    <script>
        document.getElementById('timestamp').textContent = new Date().toLocaleString();
        
        // æ‰€æœ‰ GPT æ¨¡å‹åˆ—è¡¨ï¼ˆä¸åŒ…æ‹¬æœ‰é—®é¢˜çš„ o ç³»åˆ—ï¼‰
        const allGPTModels = [
            // GPT-3.5 ç³»åˆ—
            "openrouter:openai/gpt-3.5-turbo",
            "openrouter:openai/gpt-3.5-turbo-0613",
            "openrouter:openai/gpt-3.5-turbo-16k",
            "openrouter:openai/gpt-3.5-turbo-instruct",
            
            // GPT-4 ç³»åˆ—
            "openrouter:openai/gpt-4",
            "openrouter:openai/gpt-4-0314",
            "openrouter:openai/gpt-4-1106-preview",
            "openrouter:openai/gpt-4-turbo",
            "openrouter:openai/gpt-4-turbo-preview",
            
            // GPT-4.1 ç³»åˆ—
            "openrouter:openai/gpt-4.1",
            "openrouter:openai/gpt-4.1-mini",
            "openrouter:openai/gpt-4.1-nano",
            
            // GPT-4o ç³»åˆ—
            "openrouter:openai/gpt-4o",
            "openrouter:openai/gpt-4o-2024-05-13",
            "openrouter:openai/gpt-4o-2024-08-06",
            "openrouter:openai/gpt-4o-2024-11-20",
            "openrouter:openai/gpt-4o-audio-preview",
            "openrouter:openai/gpt-4o-mini",
            "openrouter:openai/gpt-4o-mini-2024-07-18",
            "openrouter:openai/gpt-4o-mini-search-preview",
            "openrouter:openai/gpt-4o-search-preview",
            "openrouter:openai/gpt-4o:extended",
            
            // GPT-5 ç³»åˆ—
            "openrouter:openai/gpt-5",
            "openrouter:openai/gpt-5-chat",
            "openrouter:openai/gpt-5-codex",
            "openrouter:openai/gpt-5-image",
            "openrouter:openai/gpt-5-image-mini",
            "openrouter:openai/gpt-5-mini",
            "openrouter:openai/gpt-5-nano",
            "openrouter:openai/gpt-5-pro",
            
            // GPT-5.1 ç³»åˆ—
            "openrouter:openai/gpt-5.1",
            "openrouter:openai/gpt-5.1-chat",
            "openrouter:openai/gpt-5.1-codex",
            "openrouter:openai/gpt-5.1-codex-max",
            
            // GPT-5.2 ç³»åˆ—
            "openrouter:openai/gpt-5.2",
            "openrouter:openai/gpt-5.2-chat",
            "openrouter:openai/gpt-5.2-pro"
        ];
        
        // æ›´æ–°æ€»æ¨¡å‹æ•°
        document.getElementById('total-models').textContent = allGPTModels.length;
        
        const modelGrid = document.getElementById('model-grid');
        const progressText = document.getElementById('progress-text');
        const progressFill = document.getElementById('progress-fill');
        const summaryDiv = document.getElementById('summary');
        const summaryContent = document.getElementById('summary-content');
        
        let testResults = new Map();
        let isTesting = false;
        let currentIndex = 0;
        let timeoutId = null;
        const TIMEOUT_MS = 30000; // 30ç§’è¶…æ—¶ï¼ˆGPTæ¨¡å‹é€šå¸¸è¾ƒå¿«ï¼‰
        
        // åˆ›å»ºæ¨¡å‹å¡ç‰‡
        function createModelCard(modelName) {
            const card = document.createElement('div');
            card.className = 'model-card testing';
            card.id = `card-${modelName.replace(/[:\/.-]/g, '_')}`;
            card.innerHTML = `
                <div class="model-name">${modelName.split('/').pop()}</div>
                <div class="model-status">æµ‹è¯•ä¸­...</div>
                <div class="model-details" style="display: none;"></div>
                <div style="margin-top: 5px;">
                    <input type="checkbox" class="model-select" checked> é€‰ä¸­
                </div>
            `;
            
            // ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…
            card.addEventListener('click', (e) => {
                if (!e.target.classList.contains('model-select')) {
                    const details = card.querySelector('.model-details');
                    details.style.display = details.style.display === 'none' ? 'block' : 'none';
                }
            });
            
            return card;
        }
        
        // æ›´æ–°æ¨¡å‹å¡ç‰‡
        function updateModelCard(modelName, result) {
            const cardId = `card-${modelName.replace(/[:\/.-]/g, '_')}`;
            const card = document.getElementById(cardId);
            if (!card) return;
            
            const statusDiv = card.querySelector('.model-status');
            const detailsDiv = card.querySelector('.model-details');
            
            if (result.success) {
                card.className = 'model-card success';
                statusDiv.innerHTML = `âœ… æˆåŠŸ (${result.duration}ms)`;
                
                // æ˜¾ç¤ºå“åº”æ‘˜è¦
                let responseText = '';
                if (typeof result.response === 'string') {
                    responseText = result.response.substring(0, 50);
                } else if (result.response?.message?.content) {
                    responseText = result.response.message.content.substring(0, 50);
                }
                
                detailsDiv.innerHTML = `<div>å“åº”: ${responseText}...</div>`;
                
            } else if (result.error === 'timeout') {
                card.className = 'model-card error';
                statusDiv.innerHTML = 'â° è¶…æ—¶';
                detailsDiv.innerHTML = 'è¶…è¿‡30ç§’æ— å“åº”';
            } else {
                card.className = 'model-card error';
                statusDiv.innerHTML = 'âŒ å¤±è´¥';
                
                let errorMsg = '';
                if (result.error?.error?.message) {
                    errorMsg = result.error.error.message;
                } else if (result.error?.message) {
                    errorMsg = result.error.message;
                } else {
                    errorMsg = JSON.stringify(result.error).substring(0, 100);
                }
                
                detailsDiv.innerHTML = `<div>é”™è¯¯: ${errorMsg}</div>`;
            }
            
            // å­˜å‚¨ç»“æœ
            testResults.set(modelName, result);
        }
        
        // æµ‹è¯•å•ä¸ªæ¨¡å‹
        async function testSingleModel(modelName) {
            return new Promise(async (resolve) => {
                let timeout = false;
                
                // è®¾ç½®è¶…æ—¶
                timeoutId = setTimeout(() => {
                    timeout = true;
                    updateModelCard(modelName, { 
                        model: modelName, 
                        success: false, 
                        error: 'timeout' 
                    });
                    resolve({ model: modelName, success: false, error: 'timeout' });
                }, TIMEOUT_MS);
                
                try {
                    console.log(`æµ‹è¯•: ${modelName}`);
                    const startTime = Date.now();
                    
                    // ä½¿ç”¨ç®€å•çš„é—®é¢˜æµ‹è¯•
                    const response = await puter.ai.chat("AIæ˜¯ä»€ä¹ˆï¼Ÿç”¨ä¸€å¥è¯å›ç­”ã€‚", {
                        model: modelName,
                        max_tokens: 50,
                        temperature: 0.3
                    });
                    
                    const endTime = Date.now();
                    
                    if (!timeout) {
                        clearTimeout(timeoutId);
                        updateModelCard(modelName, {
                            model: modelName,
                            success: true,
                            response: response,
                            duration: endTime - startTime
                        });
                        resolve({ 
                            model: modelName, 
                            success: true, 
                            response: response,
                            duration: endTime - startTime
                        });
                    }
                } catch (error) {
                    if (!timeout) {
                        clearTimeout(timeoutId);
                        updateModelCard(modelName, {
                            model: modelName,
                            success: false,
                            error: error
                        });
                        resolve({ 
                            model: modelName, 
                            success: false, 
                            error: error 
                        });
                    }
                }
            });
        }
        
        // é¡ºåºæµ‹è¯•æ‰€æœ‰æ¨¡å‹
        async function startSequentialTest() {
            if (isTesting) return;
            isTesting = true;
            currentIndex = 0;
            testResults.clear();
            
            // æ¸…é™¤å¹¶é‡æ–°åˆ›å»ºç½‘æ ¼
            modelGrid.innerHTML = '';
            allGPTModels.forEach(model => {
                modelGrid.appendChild(createModelCard(model));
            });
            
            // é‡ç½®æ˜¾ç¤º
            summaryDiv.style.display = 'none';
            progressFill.style.width = '0%';
            
            for (let i = 0; i < allGPTModels.length; i++) {
                if (!isTesting) break;
                
                currentIndex = i;
                const model = allGPTModels[i];
                
                // æ›´æ–°è¿›åº¦
                const progress = ((i + 1) / allGPTModels.length) * 100;
                progressFill.style.width = `${progress}%`;
                progressText.innerHTML = `æµ‹è¯•ä¸­: ${model.split('/').pop()} (${i + 1}/${allGPTModels.length})`;
                
                // æµ‹è¯•å½“å‰æ¨¡å‹
                await testSingleModel(model);
                
                // ç­‰å¾…500mså†æµ‹è¯•ä¸‹ä¸€ä¸ªï¼Œé¿å…é€Ÿç‡é™åˆ¶
                if (isTesting && i < allGPTModels.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
            }
            
            if (isTesting) {
                progressText.innerHTML = 'æµ‹è¯•å®Œæˆï¼';
                progressFill.style.width = '100%';
                displaySummary();
                isTesting = false;
            }
        }
        
        // æµ‹è¯•é€‰ä¸­çš„æ¨¡å‹
        async function testSelectedModels() {
            const selectedCheckboxes = document.querySelectorAll('.model-select:checked');
            const selectedModels = [];
            
            selectedCheckboxes.forEach(checkbox => {
                const card = checkbox.closest('.model-card');
                if (card) {
                    const modelName = card.querySelector('.model-name').textContent;
                    // æ‰¾åˆ°å®Œæ•´æ¨¡å‹å
                    const fullModelName = allGPTModels.find(m => m.includes(modelName));
                    if (fullModelName) {
                        selectedModels.push(fullModelName);
                    }
                }
            });
            
            if (selectedModels.length === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ¨¡å‹');
                return;
            }
            
            // æµ‹è¯•é€‰ä¸­çš„æ¨¡å‹
            for (let i = 0; i < selectedModels.length; i++) {
                const model = selectedModels[i];
                
                // æ›´æ–°è¿›åº¦
                progressText.innerHTML = `æµ‹è¯•é€‰ä¸­æ¨¡å‹: ${model.split('/').pop()} (${i + 1}/${selectedModels.length})`;
                
                // æµ‹è¯•æ¨¡å‹
                await testSingleModel(model);
                
                // ç­‰å¾…
                if (i < selectedModels.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
            }
            
            progressText.innerHTML = 'é€‰ä¸­æ¨¡å‹æµ‹è¯•å®Œæˆï¼';
            displaySummary();
        }
        
        // åœæ­¢æµ‹è¯•
        function stopTest() {
            isTesting = false;
            if (timeoutId) {
                clearTimeout(timeoutId);
            }
            progressText.innerHTML = 'æµ‹è¯•å·²åœæ­¢';
        }
        
        // æ¸…é™¤ç»“æœ
        function clearResults() {
            modelGrid.innerHTML = '';
            testResults.clear();
            summaryDiv.style.display = 'none';
            progressText.innerHTML = 'ç»“æœå·²æ¸…é™¤';
            progressFill.style.width = '0%';
        }
        
        // åº”ç”¨è¿‡æ»¤
        function applyFilters() {
            const versionFilter = document.getElementById('version-filter').value;
            const statusFilter = document.getElementById('status-filter').value;
            
            allGPTModels.forEach(model => {
                const card = document.getElementById(`card-${model.replace(/[:\/.-]/g, '_')}`);
                if (!card) return;
                
                let showCard = true;
                
                // ç‰ˆæœ¬è¿‡æ»¤
                if (versionFilter !== 'all') {
                    const modelVersion = model.toLowerCase();
                    if (versionFilter === '3.5' && !modelVersion.includes('3.5')) showCard = false;
                    if (versionFilter === '4' && !modelVersion.includes('gpt-4') && !modelVersion.includes('4.1')) showCard = false;
                    if (versionFilter === '4o' && !modelVersion.includes('4o')) showCard = false;
                    if (versionFilter === '5' && !modelVersion.includes('gpt-5') && !modelVersion.includes('5.1') && !modelVersion.includes('5.2')) showCard = false;
                    if (versionFilter === '5.1' && !modelVersion.includes('5.1')) showCard = false;
                    if (versionFilter === '5.2' && !modelVersion.includes('5.2')) showCard = false;
                }
                
                // çŠ¶æ€è¿‡æ»¤
                if (statusFilter !== 'all') {
                    const cardClass = card.className;
                    if (statusFilter === 'success' && !cardClass.includes('success')) showCard = false;
                    if (statusFilter === 'error' && !cardClass.includes('error')) showCard = false;
                    if (statusFilter === 'testing' && !cardClass.includes('testing')) showCard = false;
                }
                
                card.style.display = showCard ? 'block' : 'none';
            });
        }
        
        // é‡ç½®è¿‡æ»¤
        function resetFilters() {
            document.getElementById('version-filter').value = 'all';
            document.getElementById('status-filter').value = 'all';
            applyFilters();
        }
        
        // æ˜¾ç¤ºæ€»ç»“
        function displaySummary() {
            const successModels = Array.from(testResults.values())
                .filter(r => r.success)
                .map(r => r.model);
            
            const failedModels = Array.from(testResults.values())
                .filter(r => !r.success)
                .map(r => r.model);
            
            const totalTested = testResults.size;
            const successCount = successModels.length;
            const failedCount = failedModels.length;
            
            summaryDiv.style.display = 'block';
            summaryContent.innerHTML = `
                <p><strong>å·²æµ‹è¯•æ¨¡å‹æ•°:</strong> ${totalTested}/${allGPTModels.length}</p>
                <p><strong>âœ… æˆåŠŸ:</strong> ${successCount} ä¸ª</p>
                <p><strong>âŒ å¤±è´¥:</strong> ${failedCount} ä¸ª</p>
                <p><strong>æˆåŠŸç‡:</strong> ${totalTested > 0 ? Math.round((successCount / totalTested) * 100) : 0}%</p>
                
                <h4>æˆåŠŸæ¨¡å‹ (${successCount}ä¸ª):</h4>
                <div style="column-count: 2; font-size: 12px;">
                    ${successModels.map(m => `<div><code>${m.split('/').pop()}</code></div>`).join('')}
                </div>
                
                ${failedCount > 0 ? `
                <h4>å¤±è´¥æ¨¡å‹ (${failedCount}ä¸ª):</h4>
                <div style="font-size: 12px; max-height: 200px; overflow-y: auto;">
                    ${failedModels.map(m => {
                        const result = testResults.get(m);
                        let errorMsg = '';
                        if (result?.error === 'timeout') {
                            errorMsg = 'è¶…æ—¶';
                        } else if (result?.error?.error?.message) {
                            errorMsg = result.error.error.message.substring(0, 100);
                        }
                        return `<div><code>${m.split('/').pop()}</code>: ${errorMsg}</div>`;
                    }).join('')}
                </div>
                ` : ''}
                
                <h4>ğŸ† æ¨èæ¨¡å‹:</h4>
                <ul>
                    <li><strong>GPT-4o-mini</strong> - æ€§ä»·æ¯”æœ€é«˜</li>
                    <li><strong>GPT-4o</strong> - åŠŸèƒ½å…¨é¢</li>
                    <li><strong>GPT-3.5-turbo</strong> - ç»å…¸ç¨³å®š</li>
                    ${successModels.some(m => m.includes('gpt-5')) ? '<li><strong>GPT-5ç³»åˆ—</strong> - æœ€æ–°æŠ€æœ¯</li>' : ''}
                </ul>
            `;
            
            // æ»šåŠ¨åˆ°æ€»ç»“
            summaryDiv.scrollIntoView({ behavior: 'smooth' });
        }
        
        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºæ‰€æœ‰æ¨¡å‹å¡ç‰‡
        window.onload = function() {
            allGPTModels.forEach(model => {
                modelGrid.appendChild(createModelCard(model));
            });
            
            console.log(`å‡†å¤‡æµ‹è¯• ${allGPTModels.length} ä¸ª GPT æ¨¡å‹`);
            console.log('æŒ‰éœ€ç‚¹å‡»"å¼€å§‹é¡ºåºæµ‹è¯•"æŒ‰é’®');
        };
        
        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                e.preventDefault();
                startSequentialTest();
            }
        });
    </script>
    
    <div style="margin-top: 30px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
        <h3>ä½¿ç”¨è¯´æ˜</h3>
        <ul>
            <li><strong>å¼€å§‹é¡ºåºæµ‹è¯•</strong>ï¼šé€ä¸ªæµ‹è¯•æ‰€æœ‰æ¨¡å‹ï¼ˆçº¦éœ€15-20åˆ†é’Ÿï¼‰</li>
            <li><strong>æµ‹è¯•é€‰ä¸­æ¨¡å‹</strong>ï¼šåªæµ‹è¯•å‹¾é€‰çš„æ¨¡å‹</li>
            <li><strong>è¿‡æ»¤åŠŸèƒ½</strong>ï¼šæŒ‰ç‰ˆæœ¬æˆ–çŠ¶æ€è¿‡æ»¤æ˜¾ç¤ºç»“æœ</li>
            <li><strong>å¡ç‰‡ç‚¹å‡»</strong>ï¼šç‚¹å‡»å¡ç‰‡æŸ¥çœ‹è¯¦æƒ…/é”™è¯¯ä¿¡æ¯</li>
            <li><strong>å¿«æ·é”®</strong>ï¼šCtrl+Enter å¼€å§‹æµ‹è¯•</li>
        </ul>
        
        <h4>é¢„æœŸç»“æœï¼š</h4>
        <ul>
            <li>âœ… GPT-3.5ç³»åˆ— - åº”è¯¥å¤§éƒ¨åˆ†æˆåŠŸ</li>
            <li>âœ… GPT-4ç³»åˆ— - åº”è¯¥æˆåŠŸ</li>
            <li>âœ… GPT-4oç³»åˆ— - åº”è¯¥æˆåŠŸ</li>
            <li>âš ï¸ GPT-5ç³»åˆ— - éƒ¨åˆ†å¯èƒ½å¤±è´¥ï¼ˆè¾ƒæ–°æ¨¡å‹ï¼‰</li>
            <li>âŒ æ—§ç‰ˆæœ¬ï¼ˆå¦‚gpt-4-0314ï¼‰- å¯èƒ½å·²ä¸‹çº¿</li>
        </ul>
    </div>
</body>
</html>
